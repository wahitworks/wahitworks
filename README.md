PWA 구현 기록

## PWA 기능 및 커스텀 설치 버튼 테스트 방법

프로젝트에 구현된 PWA(Progressive Web App) 기능과 커스텀 "앱 설치" 버튼의 동작을 테스트하는 방법입니다.

**중요:** PWA 설치 이벤트는 앱이 설치되지 않은 사용자에게만 발생하므로, 이전에 테스트하며 앱을 설치했다면 먼저 삭제해야 합니다.

### 1. 이전 PWA 앱 삭제

- 크롬/엣지 브라우저의 경우, 주소창에 `chrome://apps` 를 입력하여 앱 목록으로 이동합니다.
- '대구맑음' 또는 'wahitworks' 이름의 앱을 찾아 마우스 오른쪽 버튼을 클릭한 후, **"제거"** 또는 **"Uninstall"**을 선택하여 삭제합니다.

### 2. 프로젝트 빌드 및 미리보기

테스트는 반드시 프로덕션 빌드 결과물을 통해 진행해야 합니다.

```bash
# 1. 프로젝트를 프로덕션 모드로 빌드합니다.
npm run build

# 2. 빌드된 결과물을 로컬 서버에서 실행합니다.
npm run preview
```

### 3. 브라우저에서 확인

1.  `npm run preview` 실행 후 터미널에 나타난 `http://localhost:...` 주소로 접속합니다.
2.  페이지와 몇 초간 상호작용을 합니다 (클릭, 스크롤 등).
3.  화면 하단에 파란색 **"앱 설치"** 버튼이 나타나는지 확인합니다.
4.  버튼을 클릭했을 때, 브라우저의 공식 앱 설치 확인 창이 정상적으로 뜨는지 확인합니다.

### PWA 설치 모달 재확인 (개발용)

사용자가 '나중에' 버튼을 클릭하여 모달이 더 이상 나타나지 않을 때, 개발 목적으로 모달을 다시 확인하고 싶다면 다음 단계를 따르세요:

1.  앱이 실행 중인 브라우저에서 **개발자 도구(F12)**를 엽니다.
2.  **Application 탭**으로 이동합니다.
3.  왼쪽 메뉴에서 **'Local Storage'**를 확장하고, 앱의 주소(예: `http://localhost:4173`)를 클릭합니다.
4.  키 목록에서 **`installDeclined`**를 찾아서 삭제합니다.
5.  페이지를 **새로고침(F5)**하면 커스텀 설치 모달이 다시 나타날 것입니다.

---

## PWA 구축 과정 요약

이 프로젝트의 PWA 기능은 다음 단계를 통해 구현되었습니다.

1.  **`vite-plugin-pwa` 설치**: Vite 환경에서 PWA를 쉽게 구현하기 위한 플러그인을 설치했습니다. (`npm install vite-plugin-pwa -D`)

2.  **`vite.config.js` 설정**: 설치한 플러그인을 Vite 설정 파일에 추가하고, `manifest` 정보(앱 이름, 아이콘, 테마 색상 등)와 서비스 워커의 동작 방식을 설정했습니다.

3.  **`index.html` 수정**: `theme-color`와 `apple-touch-icon` 메타 태그를 추가하여, 다양한 모바일 환경에서의 앱 디자인 통일성과 호환성을 확보했습니다.

4.  **커스텀 설치 버튼 구현**: `App.jsx` 컴포넌트에서 `beforeinstallprompt` 이벤트를 감지하여, 기본 설치 UI 대신 직접 만든 "앱 설치" 버튼을 통해 사용자가 원하는 시점에 앱을 설치하도록 유도하는 기능을 구현했습니다.

---

## `manifest` 주요 설정 및 수정 가이드

앱의 이름, 아이콘, 테마 색상 등 PWA 관련 정보는 `vite.config.js` 파일 내의 `VitePWA` 설정 객체 안에 있는 `manifest` 객체에서 수정할 수 있습니다.

```javascript
// vite.config.js

// ...
VitePWA({
  // ...
  manifest: {
    // 앱 전체 이름 (설치 시, 스플래시 화면 등에서 표시)
    name: "대구맑음",
    // 홈 화면의 아이콘 아래에 표시될 짧은 이름
    short_name: "대구맑음",
    // 앱에 대한 간단한 설명
    description: "대구의 대기질 정보를 알려주는 앱",
    // 앱의 상단 바, 제목 표시줄 등에 적용될 테마 색상
    theme_color: "#ffffff",
    // 앱 아이콘 목록
    icons: [
      {
        src: "src/assets/logos/deagumalguem-logo-512-6.svg",
        sizes: "512x512",
        type: "image/svg+xml",
        purpose: "any maskable", // 아이콘의 용도 (any: 일반, maskable: 다양한 모양의 아이콘 마스크에 대응)
      },
    ],
  },
});
// ...
```

### 수정 Tip

- **아이콘 변경**: `icons` 배열에 새 아이콘 정보를 추가하거나 기존 정보를 수정할 수 있습니다. `vite-plugin-pwa`는 고해상도의 아이콘 소스(`src`) 하나만 잘 지정해주면, 필요한 다른 크기의 아이콘들을 자동으로 생성해주는 기능이 있으므로 보통은 가장 큰 아이콘 하나만 관리하는 것이 편리합니다.
- **`purpose: 'maskable'`**: 안드로이드 등 일부 OS에서는 아이콘을 동그라미, 네모 등 다양한 모양으로 보여줍니다. `maskable` 아이콘은 아이콘의 핵심 로고가 잘리지 않고 다양한 모양에 대응할 수 있도록 도와주는 중요한 속성입니다.
